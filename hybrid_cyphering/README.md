<table id="maintable">
<colgroup>
<col width="200"><col> <col width="130"></colgroup><tbody><tr><td><b>Termín odevzdání:</b></td><td><b>30.04.2023 23:59:59</b></td><td id="countdown">1600155.221 sec</td></tr><tr><td><b>Max. hodnocení:</b></td><td colspan="2"><b>6.0000</b> (bez bonusů)</td></tr><tr><td colspan="3">


<p>Vaším úkolem je realizovat dvě funkce (<code>seal</code> a <code>open</code>), které šifrují/dešifrují data pomocí hybridního šifrování.</p><p>Parametry Vámi implementované funkce <code>seal</code>:</p><pre>bool seal(const char * inFile, const char * outFile, const char * publicKeyFile, const char * symmetricCipher)
</pre><ul><li><code>inFile</code> - soubor, který obsahuje binární data určená k zašifrování,</li><li><code>outFile</code> - výstupní soubor, kam uložíte všechny potřebné údaje k dešifrování,</li><li><code>publicKeyFile</code> - veřejný klíč, který bude použit k zašifrování symetrického klíče,</li><li><code>symmetricCipher</code> - název symetrické šifry použité pro šifrování,</li><li>návratová hodnota je <code>true</code> v případě úspěchu, <code>false</code> v opačném případě. Pokud funkce selže, musíte zaručit, že výstupní soubor <code>outFile</code> nebude existovat.</li></ul><p>Funkce vygeneruje symetrický (sdílený) klíč a inicializační vektor (dále IV), který bude vstupem do symetrické šifry <code>symmetricCipher</code>. Touto šifrou, klíčem a IV zašifrujete data v <code>inFile</code>. Klíč k symetrické šifře zašifrujete asymetrickou šifrou (RSA) pomocí veřejného klíče uloženého v <code>publicKeyFile</code>.</p><p>OpenSSL udělá většinu práce za vás:</p><ul><li><code>PEM_read_PUBKEY</code> - načte veřejný klíč,</li><li><code>EVP_SealInit</code> - vygeneruje sdílený klíč a IV (pokud je potřeba), zašifruje sdílený klíč a nastaví kontext,</li><li><code>EVP_SealUpdate</code> a <code>EVP_SealFinal</code> fungují stejně jako v předchozích úkolech.</li></ul><p>Hybridní šifrování počítá s šifrováním pro více adresátů. Data jsou zašifrována jen jednou, jedním sdíleným klíčem a IV, ale sdílený klíč může být zašifrován více veřejnými klíči. Proto funkce přijímá pole veřejných klíčů.</p><p>Výstupní soubor bude mít následující strukturu:</p><table id="headerFileTable"><thead><tr><th>Pozice v souboru</th><th>Délka</th><th>Struktura</th><th>Popis</th></tr></thead><tbody><tr><td>0</td><td>4 B</td><td>int</td><td>NID - numerical identifier for an OpenSSL cipher. (Použitá symetrická šifra)</td></tr><tr><td>4</td><td>4 B</td><td>int</td><td><code>EKlen</code> - délka zašifrovaného klíče</td></tr><tr><td>8</td><td><code>EKlen</code> B</td><td>pole unsigned char</td><td>Zašifrovaný klíč pomocí RSA</td></tr><tr><td>8 + <code>EKlen</code></td><td><code>IVlen</code> B</td><td>pole unsigned char</td><td>Inicializační vektor (pokud je potřeba)</td></tr><tr><td>8 + <code>EKlen</code> + <code>IVlen</code></td><td>—</td><td>pole unsigned char</td><td>Zašifrovaná data</td></tr></tbody></table><hr><p>Parametry Vámi implementované funkce <code>open</code>:</p><pre>bool open(const char * inFile, const char * outFile, const char * privateKeyFile)
</pre><ul><li><code>inFile</code> - zašifrovaný soubor ve stejném formátu jako je výstupní soubor z funkce <code>seal</code>,</li><li><code>outFile</code> - výstupní soubor, kam uložíte všechna dešifrovaná data (je očekávána binární shoda se vstupním souborem do <code>seal</code> funkce),</li><li><code>privateKeyFile</code> - privátní klíč určený pro dešifrování zašifrovaného klíče,</li><li>návratová hodnota je <code>true</code> v případě úspěchu, <code>false</code> v opačném případě. Pokud funkce selže, musíte zaručit, že výstupní soubor <code>outFile</code> nebude existovat.</li></ul><p>V této funkci budou hlavní roli hrát funkce <code>PEM_read_PrivateKey</code>, <code>EVP_OpenInit</code>, <code>EVP_OpenUpdate</code> a <code>EVP_OpenFinal</code>.</p><hr><p><strong>Obsah ukázkových dat:</strong></p><ul><li><code>PublicKey.pem</code> - veřejný klíč (schválně ho zkuste otevřit jako txt),</li><li><code>PrivateKey.pem</code> - privátní klíč,</li><li><code>sample.cpp</code> - soubor s deklaracemi a základním testem,</li><li><code>sealed_sample.bin</code> - zašifrovaný soubor, na kterém můžete testovat dešifrování. Byl zašifrován přiloženým veřejným klíčem a po dešifrování v něm naleznete ASCII text. Pokud zašifrujete stejná data, pak soubor nebude stejný jako <code>sealed_sample.bin</code> - byl použit jiný klíč a IV.</li></ul></tr><tr><td colspan="2"></tbody></table>